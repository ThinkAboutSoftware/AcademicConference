# 9장 코드를 재사용하고 일반화할 수 있도록 하라

## # 논의 내용

전역 변수에 대해서 이야기를 나눠보면 좋을 것 같습니다.

각자가 생각하는 전역 변수의 장점은 무엇이고 또 단점은 어떤 것들이 있는지 이야기 해보면 좋을 것 같아요.

## 1. 가정을 주의하라

### [문제점]

- 가정은 코드 재사용 시 버그를 초래할 수 있다
    - 가정이 단 한가지 경우에 대해서만 정의가 되어 있을 경우 다른 해당 코드를 재사용할 때 다른 가정에서 사용될 수도 있기 때문에 버그를 발생시킬 수 있다.

### [해결책]

- 불필요한 가정을 피하라
- 가정이 필요하면 강제적으로 하라
    - 코드에 가정이 있을 때 개발자는 그것을 여전히 모를 수도 있다.
    - 따라서 이왕 할거면 강제적으로 가정을 시행해야 한다.
        - 가정이 깨졌을 경우 컴파일 되지 않는 방식으로 코드를 작성하라 → ???
        - 오류 전달 기술을 사용하라 → 의도한 가정이 깨졌을 경우 오류를 전달하라

## 2. 전역 상태를 주의하라

### [문제점]

- 전역 상태를 갖는 코드는 재사용하기에 안전하지 않을 수 있다
    - 전역변수는 프로그램 내의 모든 곳에 영향을 미칠 수 있기 때문에 해당 전역 변수를 사용할 때는 누구도 해당 코드를 다른 목적으로 재사용하지 않을 것이라는 암묵적인 가정을 전제해야 한다.
    - 하지만 이런 가정에는 결국 비용이 든다. 즉, 개발자가 이런 가정을 놓지면 오류를 발생시킬 수 있다.

### [해결책]

- 공유 상태에 의존성을 주입하라
    - 완벽하게 분리되어 있는 클래스의 경우 의존성 주입을 통해 해당 클래스를 캡슐화 시킬 수 있다.

## 3. 기본 반환값을 적절하게 사용하라

### [문제점]

- 낮은 층위의 코드의 기본 반환값은 재사용성을 해칠 수 있다
    - 낮은 층위의 코드에서 기본 값을 반환하면 기본 값과 관련된 요구 사항 변경이 되었을 때 해당 코드를 사용하는 상위 계층에서 문제가 발생할 수 있다.

### [해결책]

- 상위 수준의 코드에서 기본값을 제공하라
    - 하위 수준에서 기본값을 제공하지말고 하위 수준과 같은 계층에서 기본 값을 제공할 수 있도록 추상화를 한 다음 상위 수준에서 조건에 따라 기본값을 제공할 수 있도록 한다.
- 애초에 기본값을 전재로 한 API들이 있는데 대표적으로 C# Linq의 Enunerable.FirstOrDefault가 있다. 컬렉션 타입에서 가장 첫 번째 값을 반환하는데 첫 번째 값이 없으면 기본값을 반환한다.

## 4. 함수의 매개변수를 주목하라

### [문제점]

- 필요 이상으로 매개변수를 받는 함수는 재사용하기 어려울 수 있다
    - 함수가 한두 가지 정보만 필요로 하는데 객체나 클래스의 인스턴스를 매개변수로 사용하는 것은 코드 재사용성을 해칠 수 있다.
    - 매개변수로 전달 받은 객체나 클래스에서 필요한 한두 가지 정보를 제외한 나머지는 사용을 하지 않기 때문에 불필요한 값을 억지로 할당해야 할 수 있다.

### [해결책]

- 함수는 필요한 것만 매개변수로 받로록 하라
    - 필요한 한두 가지 값만 매개 변수로 입력 받으면 해당 함수를 재사용하기 편하다.

## 5. 제너릭의 사용을 고려하라

### [문제점]

- 특정 유형에 의존하면 일반화를 제한한다.
    - 하위 문제를 해결할 때 필요한 데이터 타입을 하드코딩 하면 다양한 상황에서 사용하기 어렵기 때문에 재사용하기 어렵다.

### [해결책]

- 제네릭을 사용하라
    - 제너릭을 활용하여 하위 문제에서 모든 데이터 유형을 사용할 수 있다면 추가적인 노력이 거의 없이 함수를 일반화 시킬 수 있다.

개인적인 생각

제네릭 + where + 인터페이스를 결합하면 정말 다양한 경우에 대해 쉽게 활용할 수 있어 유용하다.