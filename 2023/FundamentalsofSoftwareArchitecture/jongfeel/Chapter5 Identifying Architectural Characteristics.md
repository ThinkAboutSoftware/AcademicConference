## CHAPTER 5 아키텍처 특성 식별

```
논의내용)
아키텍처 특성을 식별하는 예제를 통해 고려해야할 점을 알 수 있어서 좋았던 것 같습니다.

아키텍처 특성을 고려해보는 건 실제 구현 단계에서는 확인하기가 어려우니까 도메인 관심사 중에 중요하게 생각해서 경험했던 예를 하나 얘기해 보면 좋을 것 같습니다.

저의 경우는 보통 유저 만족에 대한 도메인 관심사를 중점으로 두는데, 그 이유는 소프트웨어를 개발하는 최종 목적이 고객 만족이라고 생각해서 그렇습니다.
일부 사람들은 관점이 다르니까 출시 시기나 경쟁 우위를 중요한 관심사로 두기도 하는 것 같습니다. 경쟁 우위는 특히 영업 하시는 분들이나 파워 유저 층에서 매우 높은 도메인 관심사이죠.
```

아키텍처를 구축하거나 기존 아키텍처의 타당성을 검증할 때 제일 먼저 해야 할은 아키텍처 특성을 식별하는 것이다.
아키텍처 특성을 식별하기 위해 도메인을 잘 이해하고 있어야 하며, 도메인 이해관계자들과 협력하여 도메인 관점에서 중요한 것을 결정해야 한다.

### 5.1 도메인 관심사에서 아키텍처 특성 도출

아키텍트는 도메인의 핵심 목표와 현재 상황을 고려하여 도메인 관심사를 '~성'으로 해석한 후, 그에 따라 정확하고 합리적인 아키텍처 결정을 내려야 한다.

도메인 이해관계자와 협력해서 주요 아키텍처 특성을 정의하는 한 가지 팁은, 최종 목록을 가능한 한 짧게 하는 것이다. 지원하려는 아키텍처 특성을 다 고려하면 복잡성이 증가하므로 아키텍처 특성의 개수에 연연하지 말고 설계를 단순화 한다.

모든 아키텍처 특성의 우선 순위에 만장일치로 의견이 모아지는 경우는 없으므로 최종 목록에서 중요한 특성 3개를 뽑는 것이 좋은 방법이다.

도메인 이해관계자와 아키텍트는 서로 다른 언어로 말을 하고 상대방을 잘 이해하지 못하는 상황에 직면한다. 그래서 도메인 관심사를 아키텍처 특성으로 옮겨야 하는데 일반적인 특성을 정리하면 다음과 같다.

좌: 도메인 관심사, 우: 아키텍처 특성
- 인수 합병: 상호운용성, 확장성, 적응성, 신장성
- 출시 시기: 민첩성, 시험성, 배포성
- 유저 만족: 성능, 가용성, 내고장성, 시험성, 배포성, 민첩성, 보안
- 경쟁 우위: 민첩성, 시험성, 배포성, 확장성, 가용성, 내고장성
- 시간 및 예산: 단순성, 실행성

민첩성이 꼭 출시 시기를 의미하는 것이 아니다. 한가지 아키텍처 특성 만으로 도메인 관심사를 만족할 수 없고, 민첩성 + 시험성 + 배포성에 대한 특성이 적절하게 구성되어야 한다.

### 5.2 요구사항에서 아키텍처 특성 도출

요구사항 정의서에 명시된 문장에서 도출한 아키텍처 특성의 예로 예상 유저수와 그에 따른 확장 문제는 도메인 관심사에서 빠지지 않는 내용이다. 아키텍트가 알고 있는 도메인 지식에서 도출되는 특성도 있는데, 아키텍트가 도메인 지식을 가지고 있으면 좋은 이유이기도 하다.

예)
대학교 수강신청 시스템은 수강신청 마감 때 학생이 몰려 트래픽이 발생하는 걸 감안해서 문제없는 시스템을 설계해야 한다. 이는 요구사항 정의에서 적혀 있지는 않지만 아키텍트의 도메인 지식을 통해 설계 결정에 반영해야 한다.

**아키텍처 카타의 유래**

카타 훈련의 기본은 아키텍트에게 도메인 용어와 (요구사항에는 없지만 설계에는 영향을 미칠 수 있는) 부가 콘텍스트로 기술된 문제를 제공하는 것이다.

각 카타에는 미리 정의된 섹션이 있다.

- 설명description: 시스템으로 해결하려는 전체 도메인 문제
- 유저users: 시스템을 사용할 것으로 예상되는 유저의 유형과 인원수
- 요구사항requirements: 아키텍트가 도메인 유저 및 도메인 전문가의 말을 듣고 예상하는 도메인/도메인 수준의 요구사항

여기에 부가 콘텍스트 섹션을 덧붙여 훈련의 현실감을 더한다.

- 부가 콘텍스트additional context: 요구사항에는 명확하게 기술되어 있지 않지만 아키텍트가 암묵적인 문제 영역에 관함 지식을 이용해 반드시 고려해야 할 여러 가지 항목들

### 5.3 사례 연구: 실리콘 샌드위치

실리콘 샌드위치 카타를 예로 아키텍트가 요구사항을 바탕으로 아키텍처 특성을 도출하는 방법 소개

**설명**

실리콘 샌드위치는 전국 가맹점을 보유한 샌드위치 브랜드로, (현재의 매장 서비스와 병행하여) 온라인 주문 시스템을 구축하려고 한다.

**유저**

앞으로 수천 명, 어쩌면 수백만 명에 달할 지도 모른다.

**요구사항**

- 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달받는다(교통 정보가 포함된 여러 외부 지도 서비스와의 연계는 필수임)
- 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달한다.
- 모바일 기기에서도 이용 가능하다.
- 전국 어느 지점이나 이용 가능한 프로모션/스페셜 행사를 제공한다.
- 특정 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사를 제공한다.
- 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션을 제공한다.

**부가 콘텍스트**

- 샌드위치 지점은 가맹점이므로 소유자가 다 다르다.
- 모회사는 머지않아 해외 시장도 진출할 계획이다.
- 이 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표다.

아키텍트는 도메인 요구사항을 충족하는 전체 시스템을 코드 레벨로 설계하는 것이 아니라, 설계 특히 구조와 관련이 있거나 영향을 미치는 것들을 찾아내는 것이다. 명시적, 암묵적 특성을 분류한다.

#### 5.3.1 명시적 특성

명시적 아키텍처 특성은 필요한 설계의 일부로 요구사항 정의서에 기술된다.

유저에 대한 설명으로 수천명, 수백만명을 예상하고 있으므로 확장성, 즉 유의미한 성능 저하 없이 다수의 동시 유저를 처리하는 능력이 무엇보다 중요한 아키텍처 특성으로 생각할 수 있다. 요구사항 정의서에 확장성은 명시되어 있지 않지만 예상 유저수를 보면 명시된 것이라고 봐도 무방하다. 아키텍트는 이런 도메인 언어를 엔지니어링 언어로 해독해서 판단해야 한다.

순간적으로 폭증한 유저 요청을 처리하려면 탄력성도 필요하다. 확장성과 탄력성에 대한 특성은 제약조건이 다르다.
확장성은 좋지만 탄력적이지 않은 시스템은 호텔 예약 시스템이다. 하지만 콘서트 티켓 예약 시스템은 티켓 발매 시간에 사이트에 팬들이 몰려드므로 탄력성이 크지 않으면 시스템이 버틸 수 없다.

탄력성이 필수라는 문구는 요구사항 정의서에 없지만, 아키텍트는 탄력성을 중요한 고려 사항으로 식별해야 한다. 여기서도 문제 영역 안에 요구사항이 숨어 있는 경우이다. 유능한 아키텍트는 샌드위치 지점의 사용 트래픽이 식사 시간 전후로 급증할 것으로 예측하고 이런 아키텍처 특성을 발견할 수 있어야 한다.

아키텍트는 비즈니스 요구사항을 검토하면서 아키텍처 특성이 존재하는지 확인한다.

1. 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달받는다(교통 정보가 포함된 여러 외부 지도 서비스와의 연계는 필수임)

외부 지도 서비스는 신뢰성과 같은 특성에 영향을 미칠 수 있다.

2. 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달한다.

별다른 아키텍처 특성은 필요하지 않음

3. 모바일 기기에서도 이용 가능하다.

애플리케이션 설계시에 이식성을 위해 웹으로 할지 네이티브 웹으로 할지 방향성을 결정하는 것처럼 큰 비중을 차지한다. 예산은 한정되어 있으므로 모바일에 최적화된 웹 애플리케이션 개발로 정하고 모바일 환경에 민감한 성능 아키텍처 특성을 정의할 수 있다.

4. 전국 어느 지점이나 이용 가능한 프로모션/스페셜 행사를 제공한다.

5. 특정 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사를 제공한다.

1번 요구사항의 교통 정보 커스터마이징을 포함해서 맞춤성customizability을 아키텍처 특성으로 도출할 수 있다.

6. 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션을 제공한다.

온라인 결제에 필요한 보안 수준을 파악하기 어렵다

7. 샌드위치 지점은 가맹점이므로 소유자가 다 다르다.

이 요구사항은 아키텍처 비용에 제약을 준다. 단순하거나 기능이 조금 빠진 아키텍처로도 충분한지 타당성feasibility(비용, 시간, 직원 스킬 세트 등의 제약조건 적용)을 미리 확인해야 한다.

8. 모회사는 머지않아 해외 시장도 진출할 계획이다.

국제화internationalization, 즉i18n이 필요하다. 어떤 식으로든 설계 결정에 영향을 미칠 것이다.

9. 이 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표다.

사용성이 중요해 보이지만 아키텍처 특성 보다는 설계와 더 깊은 연관이 있다.

요구사항 정의서에서 도출한 아키텍처 특성은 성능이다. 성능은 미묘한 뉘앙스가 함축된 개념으로 어떤 종류의 성능을 설계에 반영해야 하는지는 확인이 필요하다.

확장성 수scalability number와 성능 수perfomance number도 함께 정의한다. 아키텍처 특성은 서로 영향을 미치므로 서로 다른 아키텍처 특성을 상대적으로 정의할 수밖에 없다.

#### 5.3.2 암묵적 특성

요구사항 정의서에 따로 없는 아키텍처 특성도 있지만 중요한 설계 요소가 될 수도 있다. 가용성availability은 시스템에서 마땅히 지원되어야 할 암묵적인 아키텍처 특성이다. 신뢰성reliability도 시스템을 문제 없이 사용하기 위한 특성으로 고려해야 한다.

보안은 모든 시스템에 공통적인 암묵적 특성이다. 아키텍트는 보안이 설계의 구조적인 측면에 영향을 미치거나 애플리케이션에서 중요한 요소라고 판단할 경우 아키텍처 특성으로 간주한다.

서드 파티 업체가 결제 처리를 전담한다면 상식적인 보안 지침을 위반하지 않는 한, 아키텍트가 특별한 구조적 설계를 고민할 필요는 없다. 여기서 어느 한 아키텍처 특성을 지나치게 적용over-specify 함정에 빠지기 쉬운데, 시스템이 너무 복잡하게 설계되어 모자라게 적용하는under-specify 것만큼이나 해를 끼치는 경우가 많다.

아키텍처 특성을 선택하는 문제에 있어서 정답은 없으며 오직 잘못된 선택만이 있을 뿐이라는 걸 명심해야 한다.

'아키텍처에서는 틀린 답은 없고 값비싼 답만 있습니다!'

**설계 대 아키텍처, 그리고 트레이드오프**

어떤 설계가 더 나은지에 대한 대답도 팩터마다 달라진다.
첫째, 마이크로커널 아키텍처로 구현하지 않을(성능과 커플링 등의) 타당한 사유가 있는가?
둘째, 이렇게 설계하면 다르게 설계할 때보다 특별히 더 구현하기 어려운 아키텍처 특성이 있나?
셋째, 각 '설계 대 패턴'에서 모든 아키텍처 특성을 지원하려면 비용이 얼마나 들어가나?
이런 아키텍처 트레이드오프 분석은 아키텍트가 하는 중요한 업무의 일부이다.

아키텍트는 개발자, 프로젝트 관리자, 운영팀, 기타 소프트웨어 시스템 구축에 참여한 사람들의 협조를 구해야 한다. 어떤 아키텍처 결정도 그것을 구현할 팀을 배제한 채 생각할 수 없다. 그렇게 되면 끔찍한 상아탑 아키텍트Ivory Tower Architect 안티패턴에 빠지게 된다.

아키텍처에서 최고의 설계는 없다, 오직 나쁜 것 중에서 제일 나은 트레이드오프들만 있을 뿐!

가장 적합하지 않은 것을 우선 솎아내는 것도 정말 꼭 필요한 것을 결정하는 데 도움이 된다. 실리콘 샌드위치에서 덜 중요한 특성은? 정답은 없지만 맞춤성과 성능 둘 중 하나는 포기해야 할 수도 있다. 성능을 포기한다고 해서 성능이 떨어지는 애플리케이션을 개발해도 된다는 건 아니다. 확장성이나 가용성 같은 다른 특성들보다 성능을 우선시하지 않는 애플리케이션을 구축한다는 의미이다.