## 8. 컴포넌트 기반 사고

3장에서는 모듈을 연관된 코드의 묶음이라고 했지만, 아키텍트는 보통 모듈을 불리적으로 구현한 컴포넌트로 생각한다.

개발자는 자신의 개발 플랫폼에 따라 여러 가지 방법으로 모듈을 물리적으로 패키징한다.

이렇게 모듈을 물리적으로 패키징한 것을 **컴포넌트**라고 하며 자바(jar), 닷넷(dll)처럼 대부분의 언어들이 지원하는 기능이다.

### 8.1 컴포넌트 범위

개발자는 컴포넌트 개념을 다양한 펙터에 세분화하는 것이 유용하다고 생각한다.

**컴포넌트**는 아티팩트를 한데 묶어 필요시 중첩시켜 계층화하는, 언어에 특정한 메커니즘을 제공한다.

가장 단순한 컴포넌트는 클래스보다 한 단계 높은 수준의 모듈로 코드를 래핑한 것이다..!

이 단순한 래퍼를 보통 **라이브러리**라고 한다.

라이브러리는 대개 호출부 코드와 동일한 메모리 주소에서 실행되며 해당 언어의 함수 호출 메커니즘을 사용한다.

그리고 일반적으로 라이브러리는 컴파일 타임에 의존한다.

아키텍트가 반드시 컴포넌트를 사용하는 것은 아니며 컴포넌트는 언어가 제공하는 저수준이 아닌 더 높은 고 수준에서 모듈성을 가지는 것이 더 유용할 때가 많다.

### 8.2 아키텍트 역할

아키텍트는 아키텍처 내부의 컴포넌트를 정의, 개선, 관리, 통제하는 일을 한다.  

소프트웨어 아키텍트는 4장에서 열거한 아키텍처 특성과 소프트웨어 시스템의 요구사항을 종합하여 비즈니스 분석가, 분야별 전문가, 개발자, QA 엔지니어, 운영자, 엔터프라이즈 아키텍트와 함께 소프트웨어 초기 설계를 한다.

아키텍트는 개발 프로세스의 영향을 거의 받지 않지만 예외로 애자일 소프트웨어 개발 방법론의 다양한 분야를 개척한 엔지니어링 프랙트시를 필요로 한다.

특히 CI/CD, 거버넌스 분야가 글허다..

새 프로젝트를 시작한 아키텍트는 무엇보다 먼저 컴포넌트를 식별해야 하나, 그 전에 아키텍처를 분할하는 방법을 반드시 이해해야 한다.

### 8.2.1 아키텍처 분할

소프트웨어 아키텍처 제1법칙에 따르면 소프트웨어는 만사가 다 트레이드오프이다.

주어진 아키텍처에서 컴포넌트를 만드는 방법도 마찬가지이다.  

컴포넌트는 일반적인 적재 메커니즘을 의미하므로 아키텍트는 재량껏 어떤 유형의 분할도 할 수있다..

*콘웨이의 법칙: 시스템을 설계하는 조직은 그 조직의 소통 구조를 그대로 옮겨 놓은 듯한 설계도를 그릴 수밖에 없다.*

### 8.3 개발자 역할

개발자는 아키텍트의 공동 설계한 컴포넌트를 바탕으로 클래스, 함수, 서브컴포넌트로 더 잘게 나눈다.

일반적으로 클래스, 함수 설계는 아키텍트, 기술 리더, 개발자의 공동 책임이지만 대부분 개발자가 담당한다.

개발자는 아키텍트가 설계한 컴포넌트가 최종판이라고 생각하면 안 된다.  

모든 소프트웨어 설계는 이터레이션을 거쳐 점점 다듬어진다.  

초기 설계는 일단 초안으로 보고 차후 구현을 하며 상세한 것들을 밝히고 하나씩 개선을 하면 된다.

### 8.4 컴포넌트 식별 흐름

아키텍처는 이런 주기를 반복하면서 점점 구체화된다.

따라서 아키텍처는 수정, 변형을 두려워 해서는 안된다...!

#### 8.4.1 초기 컴포넌트 식별

아키텍트는 소프트웨어 프로젝트의 소스 코드가 생기기 전에 적용할 최상위 분할의 유형에 따라 최상위 컴포넌트를 어디서부터 시작할지 결정해야 한다.

그 밖에도 아키텍트는 원하는 컴포넌트를 자유롭게 구성하면서 어느 기능을 어디에 둘지 도메인 기능을 매핑한다.  

**초기 식별한 컴포넌트들만으로 제대로 된 설계가 나올 가능성은 거의 없으니 아키텍트는 컴포넌트 설계를 이터레이션하면서 조금씩 개선해야 한다.**

#### 8.4.2 요구사항을 컴포넌트에 할당

초기 컴포넌트를 식별한 후, 아키텍트는 컴포넌트에 요구사항을 대입해서 잘 맞는지 확인한다.

이 과정에서 컴포넌트를 새로 만들거나 기존 컴포넌트를 통합하고 하는 일이 너무 많은 컴포넌트를 분해할 수 있다.

#### 8.4.3 역할 및 책임 분석

컴포넌트에 스토리를 대입할 때 아키텍트는 요구사항을 파악하는 단계에서 밝혀진 역할과 책임도 살펴보고 세분도가 적합한지 확인한다.

#### 8.4.4 아키텍처 특성 분석

컴포넌트에 요구사항을 대입할 때 아키텍트는 앞서 식별한 아키텍처 특성들이 컴포넌트 분할 및 세분도에 어떤 영향을 미치는지 살펴봐야 한다.

#### 8.4.5 컴포넌트 재구성

소프트웨어 설계에서 피드백은 항상 중요하다.

아키텍트는 개발자와 지속적으로 컴포넌트 설계를 반복해야 한다.

### 8.5 컴포넌트 세분도

컴포넌트에서 가장 적당한 세분도를 찾는 것은 아키텍트의 가장 어려운 작업 중 하나이다.

컴포넌트를 너무 잘게 나누어 설계하면 컴포넌트 간 통신이 너무 많아지고, 그렇다고 너무 크면 커플링이 증가해 배포, 테스트가 어려워 진다.

#### 8.6 컴포넌트 설계

컴포넌트 설계에 있어서 '왕도'는 없다..

팀과 조직에서 사용하는 소프트웨어 개발 프로세스와 맞물려 다양한 기술과 트레이드오프가 있겠지만, 아키텍트는 아키텍처를 설계하면서 요구사항을 접수하고 애플리케이션을 구성할 굵직굵직한 구성 요소를 그려봐야 한다.

#### 8.6.1 컴포넌트 발견

아키텍트는 개발자, 비즈니스 분석가, 도메인 전문가와 협력해서 시스템에 관한 일반적인 지식과 시스템을 어떻게 분할할지 결정하고 그에 따라 초기 컴포넌트 설계를 한다.

#### 엔티티 함정

컴포넌트를 확정하는 문제에 정답은 없지만, 엔티티 함정 안티 패턴은 자주 나오니 조심해야 한다.

#### 액터/액션 접근법

액터/액션 접근법은 아키텍트가 요구사항을 컴포넌트에 매핑할 때 즐겨 쓰는 방법이다.

아키텍트는 애플리케이션에서 뭔가 일을 하는 액터와 그들이 수행하는 액션을 식별하고 시스템의 대표적인 유저와 이들이 시스템에서 어떤 종류의 일을 하는지 찾아내는 기법이다.

#### 이벤트 스토밍

이벤트 스토밍은 도메인 주도 설계의 기법 중 하나이다.  

다양한 컴포넌트가 메시지나 이벤트를 통해 서로 통신한다고 가정한다.

따라서 팀은 요구사항과 식별된 역할에 따라 시스템에서 어떤 이벤트가 일어나는지 파악하고 컴포넌트를 이벤트와 메세지 핸들러 중심으로 구축한다.

#### 워크플로 접근법

워크플로 접근법은 이벤트 스토밍의 대안으로서, DDD나 메시징을 사용하지 않는 더 일반화한 방법이다.

지금까지 살펴본 기법들은 다 일장일단이 있으므로 어느 것이 다른 것보다 우월하다고 할 수 없다.

마찬가지로 정답은 없기 때문에 상황에 맞게 잘 대입하는 것이 중요한 능력이다.

### 느낀점

와우 정말 어렵다.. 정말 부분부분만 이해가 가능해서 많이 검색해보면서 읽은 것 같다..ㅠ

#### 논의사항
