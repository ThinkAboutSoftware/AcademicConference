### 클라이언트 세션 상태

> 세션 상태를 클라이언트에 저장한다.

#### 작동 원리

서버 중심의 설계에도 세션 식별자를 저장하기 위해 작은 클라이언트 세션 상태는 필요하다.
이를 통해 서버를 완전한 상태 비저장으로 유지할 수 있다.

데이터 전송을 위해 직렬화가 가능한 `데이터 전송 객체`를 사용한다.

HTML 인터페이스를 사용할 때는 클라이언트 세션 상태를 구현하는 데 세 가지 방법이 있다.

- URL 매개 변수
- 숨겨진 필드
- 쿠키

URL 매개변수는 적은 양의 데이터로 작업할 때 가장 쉬운 방법이다.
한계는 URL의 크기가 제한적이라는 것이지만 데이터 항목이 아주 적은 경우에는 아무 문제없이 잘 작동한다.
일부 플랫폼은 자동 URL 다시 쓰기(automatic URL rewriting)를 수행해 세션ID를 추가한다.
URL을 변경하면 즐겨찾기 기능에 문제가 생길 수 있으므로 소비자를 대상으로 하는 사이트에는 사용하기 어려울 수 있다.

숨겨진 필드는 웹 페이지에 표시되지 않지만 브라우저로 전송되는 필드이다.
숨겨진 필드에 데이터를 넣으려면 형식을 적용해야 하는데, XML은 확실한 선택 중 하나이지만 다소 장황하다.
텍스트 기반 인코딩을 사용해 데이터를 인코딩 할 수도 있다.
숨겨진 필드는 화면에만 안 나올 뿐 페이지 소스를 보면 데이터의 내용을 볼 수 있다.

쿠키는 주고받는 과정이 자동으로 처리된다.
세션 상태를 직렬화하는 방법으로 쿠키를 사용할 수 있다.

쿠키는 보안성이 없으므로 데이터가 노출된다.
또 단일 도메인 이름 내에서만 작동하므로 여러 도메인 이름으로 분리된 사이트에서는 전체 사이트에서 쿠키를 활용하기 어렵다.

쿠키가 활성화 되어 있는지 감지한 후 활성화 되어 있지 않으면 URL 다시 쓰기를 통해
클라이언트 세션 상태를 처리할 수 있다.

#### 사용 시점

클라이언트 세션 상태(Client Session State)에는 여러 장점이 있다.
최대한의 클러스터링과 장애 조치(failover) 복구 능력으로 상태 비저장 서버 객체를 지원하는 데 적합하다.

데이터의 양이 많아지면 데이터를 저장할 장소를 찾아야 하는 문제와
요청마다 데이터를 전송하는 데 걸리는 시간 때문에 사용하기 어려워질 수 있다.

클라이언트로 전송되는 데이터는 보안 문제에 취약하다.
암호화를 한다고 해도 요청마다 암호화와 해독을 하는 건 성능상 부담이 있다.
유출되면 곤란한 데이터는 안 보내는게 좋다.

세션 식별은 클라이언트 세션 상태를 사용해야 한다.
이 용도로는 숫자를 쓰므로 데이터에 대한 부담은 없다.
악성 사용자가 세션 ID를 무단으로 변경해 세션을 훔치는 세션 탈취에 대해 대비해야 한다.
세션 탈취에 대비한 랜덤 세션 ID를 쓰지만 그렇지 않다면 세션 ID에 해시를 적용해 사용하는 방법으로 한다.