### 레코드 집합

> 테이블 형식 데이터의 인메모리 표현

![image](https://github.com/jongfeel/BookReview/assets/17442457/068eabb5-e40e-450c-9b72-a3bbf8d9242b)

관계형 데이터베이스를 바탕으로 UI 위젯 도구가 생겼는데
비즈니스 논리를 추가하는 기능은 가지고 있지 않다.
따라서 저장 프로시저를 사용해 데이터베이스 안에 넣거나 UI 코드에 포함시키는 수밖에 없다.

레코드 집합(Record Set)의 기본 개념은 SQL 쿼리의 결과와 완전히 같은 형식이지만
시스템의 다른 부분에서 생성하고 관리할 수 있는 인메모리 구조를 제공해 활용할 수 있게 하는 것이다.

#### 작동 원리

레코드 집합은 직접 작성하기 보다는 소프트웨어 플랫폼에서 제공하는 경우가 많다.
ADO.NET의 데이터 집합이나 JDBC 2.0의 행 집합이 이러한 예에 해당한다.

레코드 집합의 가장 중요한 점은 데이터베이스 쿼리의 결과와 완전히 동일해 보인다는 것이다.
두 번째로 중요한 점은 레코드 집합을 활용해 도메인 논리 코드로 손쉽게 조작할 수 있다는 점이다.

레코드 집합과 데이터 원본의 연결을 분리할 수 있는 능력은 아주 유용하다.
따라서 데이터베이스 연결에 대한 걱정 없이 네트워크 상에서 레코드 집합을 전달할 수 있다.
레코드 집합을 직렬화하면 `데이터 전송 객체`로도 활용할 수 있다.

연결이 분리됐을 때 레코드 집합을 업데이트 하면 `작업 단위` 형식으로 사용해 수정한 후 데이터 원본으로 반환해서 커밋할 수 있다.

##### 명시적 인터페이스

레코드 집합 구현은 암시적 인터페이스를 사용한다.
데이터를 얻으려면 범용 메서드를 호출해야 하는데
승객 정보를 얻으려면 aReservation["passenger"] 비슷한 식을 사용한다.
명시적 인터페이스에서는 정의된 메서드와 프로퍼티가 있는 실제 예약 클래스가 필요하다.
승객을 표현하는 식은 aReservation.passenger로 작성할 수 있다.

암시적 인터페이스는 범용 레코드 집합을 어떤 종류의 데이터에도 사용할 수 있다는 점에서 유연하다.
새로운 레코드 집합을 정의해도 새로운 클래스를 작성할 필요가 없다.

승객의 성을 얻으려면
((Person)aReservation["passenger"]).lastName과 같은 알아보기 힘든 식을 사용해야 한다.
컴파일러가 모든 형식 정보를 잃어버리므로 데이터를 얻으려면 직접 이런 항목을 입력해야 한다.
명시적 인터페이스의 경우 형식 정보가 유지되므로 aReservation.passenger.lastName과 같은 식을 사용할 수 있다.

레코드 집합은 정상적인 열에 정보가 저장된다.
열 이름은 레코드 집합을 생성하는 SQL에서 정의되므로 프로퍼티를 찾는 것은 그리 어렵지 않다.

명시적 인터페이스를 만드는 게 더 좋은 방법이다.
ADO.NET은 엄격한 형식의 데이터 집합과 생성된 클래스를 제공한다.
ADO.NET 데이터 집합은 여러 테이블과 테이블간의 관계를 포함하므로 엄격한 형식의 데이터 집합도
이런 관계 정보를 활용할 수 있는 프로퍼티를 제공한다.

암시적 인터페이스가 흔히 사용되지만
ADO.NET 기반의 실무 코드에서는 형식이 지정된 데이터 집합을 사용하는 것이 좋다.
ADO.NET이 아닌 환경에서는 명시적 레코드 집합을 위한 코드 생성을 사용한다.

#### 사용 시점

레코드 집합을 지원하는 UI 도구는 다양하기 때문에 레코드 집합을 사용할 이유는 충분하다.
이런 환경을 사용하고 있다면 도메인 논리를 구성하는 데 `테이블 모듈`을 사용해야 한다.
데이터베이스에서 레코드 집합을 얻고 이를 `테이블 모듈`로 전달해 처리를 거쳐 정보를 생성하고 이를 UI로 전달해 표시 및 편집을 수행한다.
이 정보를 다시 `테이블 모듈`로 전달해 유효성을 검사한다.
마지막으로 업데이트를 데이터베이스로 커밋한다.

레코드 집합의 가치를 높이는 데 중요한 역할을 하는 도구가 개발된 데는
관계형 데이터베이스와 SQL의 꾸준한 입지, 이를 대체할 수 있는 다른 구조와 쿼리 언어의 부재가 크다.